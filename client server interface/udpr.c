//                                          compiling - gcc -g UDP_R.o -o UDP_R#include <sys/types.h>#include <sys/socket.h>#include <arpa/inet.h>#include <netinet/in.h>#include <stdio.h>#include <stdlib.h>#include <string.h>#define PORT 6000#define MCAST_IP "239.0.0.1"struct sockaddr_in saddr;struct ip_mreq imreq;int sd,len;int recv_len;char databuf[1024];//int datalen = 1024;//sizeof(databuf);FILE *fp;int i = 0,rsize = 0;void finish(char* s){	perror(s);	exit(1);} int main(int argc, char *argv[]){		//Set content of struct saddr and imreq to zero	memset((char*)&saddr, 0, sizeof(struct sockaddr_in));  	memset(&imreq, 0, sizeof(struct ip_mreq));			//Open a udp socket 	if((sd = socket(PF_INET, SOCK_DGRAM, 0)) == -1)		finish("Opening datagram socket error");	else		printf("Opening datagram socket....OK.\n");	//Bind	saddr.sin_family = PF_INET;   	saddr.sin_port = htons(PORT); // listen to port PORT   	saddr.sin_addr.s_addr = htonl(INADDR_ANY); // bind socket to any interface	if(bind(sd,(struct sockaddr*)&saddr, sizeof(struct sockaddr_in)) == -1)		finish("can not bind UDP socket!!");	else		printf("bind setting...ok.\n");	//Mcast group setting		imreq.imr_multiaddr.s_addr = inet_addr(MCAST_IP);    //the group mcast ip  	imreq.imr_interface.s_addr = 				INADDR_ANY; // use DEFAULT interface//delete htonl 		//JOIN multicast group on default interface   	setsockopt(sd, IPPROTO_IP, IP_ADD_MEMBERSHIP,&imreq, sizeof(imreq));  //////////////////////////////////	//Read from the socket	len = sizeof(saddr);	printf("UDP listener is waiting\n");				fp = popen("play -t mp3 -> /dev/null 2>&1", "w"); //open a pipe. output is sent to dev/null 	while(1){		if(recv_len = recvfrom(sd,databuf,1024,0,(struct sockaddr*) &saddr,&len) < 0)			finish("Error while receiving information !! ");								fwrite(databuf,sizeof(char),1024,fp);		memset((void *)databuf,0,1024);			}/*        while( i < datalen * 1024)   	{		rsize = recvfrom(sd, databuf, datalen, 0,(struct sockaddr *)&saddr,sizeof(struct sockaddr_in));		i += rsize;		databuf[rsize] = '\0';		printf("%s",databuf);	   }	   databuf[rsize] = '\0';	   printf("%s",databuf);	   printf("\nsupposed to receive %d bytes. actual amount received %d bytes.\nfinished receiving\n",i,1024*datalen);*/		return 0;}